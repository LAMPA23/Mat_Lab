Fd=20e3;% частота дискретизації
W=0.36;%нижня частота полосового фільтра 3КГц
f=0:10e3;%полоса частот до частоти Найквіста
n=20;%порядок фільтру
k = hamming(n+1);
b=fir1(n,W,'high',k);%розрахунок коефіцієнтів фільтра
hi=impz(b, 1);%рохрахунок імпульсної характеристики
h =freqz(b, 1, f, Fd);%розрахунок АЧХ фільтра
tau_phase=unwrap(angle(h));%розрахунок ФЧХ фільтра
subplot(2,2,1); stem(hi); grid;
subplot(2,2,2); plot(f,abs(h)); grid;
subplot(2,2,3); plot(tau_phase); grid;

